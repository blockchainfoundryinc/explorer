thead
  tr
    th.hidden-xs #{settings.locale.timestamp}
    th.hidden-xs #{settings.locale.tx_hash}
    th Tx Type
    th #{settings.locale.mkt_amount}
tbody
  each tx in txs
    - var time = format_unixtime(tx.timestamp)
    tr
      td.hidden-xs #{time} 
      td.hidden-xs
        a(href='/tx/#{tx.txid}') #{tx.txid}
      td.hiddex-xs #{tx.txtype}
      - var done = false
      - var out = 0
      - var vin = 0
      if(tx.asset_symbol === undefined)
        -//NORMAL TX
        each r in tx.vout
          if r.addresses == address.a_id
            - out = r.amount
        each s in tx.vin
          if s.addresses == address.a_id
            - vin = s.amount
        if out > 0 && vin > 0
          td.info
            - var amount = (out - vin) / 100000000
            if amount < 0
              - amount = amount * -1
              | - #{amount.toFixed(8)} #{settings.symbol}
            else if amount > 0
              | + #{amount.toFixed(8)} #{settings.symbol}
            else
              | #{amount.toFixed(8)} #{settings.symbol}
        else if out > 0
          td.success
            - var amount = out / 100000000
            | + #{amount.toFixed(8)} #{settings.symbol}
        else
          td.danger
            - var amount = vin / 100000000
            | - #{amount.toFixed(8)} #{settings.symbol}
      else
        -//ASSET TX
        -//console.log(tx.txid);
        //
          -if(tx.txtype === 'assetactivate') {
            -vin = tx.asset_total
          -}else{
            -//console.log(tx.txid, JSON.stringify(tx.asset_vout));
            -if(tx.asset_vin[0].address === address.a_id) { //address is SENDER
              -for(var i = 0; i < tx.asset_vout.length; i++) {
                -console.log(":", tx.asset_vout[i].address);
                -if(tx.asset_vout[i].address !== address.a_id) {
                  -out += tx.asset_vout[i].amount;
                -}
              -}
            -}else{ //address is RECEIVER
              -//count the amounts that DO go to this address
              -for(var x = 0; x < tx.asset_vout.length; x++) {
                -console.log(":", tx.asset_vout[x].address);
                -if(tx.asset_vout[x].address === address.a_id) {
                  -vin += tx.asset_vout[x].amount;
                -}
              -}
            -}
            -//console.log(tx.txid, "vin:", vin, "vout", out);
          -}

        if(tx.txtype === 'assetactivate')
          -vin = tx.asset_total
        else
          -vins = tx.asset_vin
          -vouts = tx.asset_vout
          if vins[0].address === address.a_id
            - console.log("WINS");


        if (out > 0 && vin > 0)
          td.info
            - var amount = (out - vin);
            if amount < 0
              - amount = amount * -1
              | - #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
            else if amount > 0
              | + #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
            else
              | #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
        else if (vin === 0 && out > 0)
          td.info
            - var amount = (vin - out);
            if amount < 0
              - amount = amount * -1
              | - #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
            else if amount > 0
              | + #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
            else
              | #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
        else if vin > 0
          td.success
            - var amount = vin
            | + #{formatAsNumber(amount, 8)} #{tx.asset_symbol}
        else if vin === out
          td.danger
            - var amount = out
            | - #{formatAsNumber(amount, 8)} #{tx.asset_symbol}